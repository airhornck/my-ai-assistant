# 终极目标：完整 IP 打造与 IP 诊断 —— 与当前改动的对齐及后续路线图

## 一、终极目标（再述）

- **产品目标**：能帮用户**打造一个完整且成功的 IP**，或**诊断当前 IP 存在哪些问题后，给出完整的打造方案**；而不是单单只能做「营销活动策划」和「活动文稿输出」。
- **关键原则**：**具体要做什么，看客户意图**。—— 即：同一套系统，根据用户说的是「帮我诊断下我的账号」「我想从 0 做一个美妆 IP」「下个月有个 618 活动要策划」等，自动识别并走不同能力路径（IP 诊断 / IP 打造方案 / 活动策划+文案）。

---

## 二、今天改动与终极目标的关系

### 2.1 今天改动在做什么

- 数据闭环、知识库独立、案例模板与打分、方法论独立、活动策略编排优化；
- 编排内 `kb_retrieve`、保存为案例（`from-session`）、prompt 中「以案例为基础改写或填空」；活动策划已收口到统一入口（方案 A：meta_workflow 内 task_type=campaign_or_copy 时走 strategy_orchestrator，`POST /api/v1/campaign/plan` 已下线）。

### 2.2 对终极目标而言：是否合理

**结论：合理，且必要，但尚不充分。**

| 维度 | 评价 | 说明 |
|------|------|------|
| **架构与扩展性** | ✅ 合理 | 意图 → 规划 → 编排、知识库/方法论/案例独立、数据闭环，都为「按意图切换不同任务」和「注入 IP 方法论/案例」留出了空间。 |
| **当前能力边界** | ⚠️ 仍偏单点 | 能力仍集中在「活动策划 + 文案生成」；没有把「IP 诊断」「完整 IP 打造方案」作为**一等任务**做意图区分、规划分支和输出结构。 |
| **意图与路由** | ⚠️ 未显式区分 IP | 意图层只有 structured_request / free_discussion / casual_chat 等，没有区分「IP 诊断」「IP 打造方案」与「活动/文案」；规划层步骤（web_search、kb_retrieve、analyze、generate…）也是通用步骤，未针对 IP 诊断/打造做专门分支或输出形态。 |

因此：**今天的修改是朝着「可扩展、可按意图调度」的正确方向在打基础，但尚未把「完整 IP 打造 / IP 诊断」真正做成与「活动策划」并列的一类能力。**

---

## 三、当前缺口（要达成终极目标还缺什么）

### 3.1 意图层：缺少「IP 级」任务区分

- **现状**：意图类型为 casual_chat / structured_request / free_discussion / document_query / command；free_discussion 下无论是「帮我诊断账号」还是「做个 618 策划」都会进同一套深度流程，由规划脑输出步骤，但**没有显式标记「这是 IP 诊断」「这是 IP 打造方案」「这是活动策划」**。
- **缺口**：需要根据用户表述，区分出至少三类**任务类型**（可仍在 free_discussion 下，用额外字段区分）：
  - **ip_diagnosis**：用户想诊断当前 IP/账号的问题；
  - **ip_building_plan**：用户想得到「完整 IP 打造方案」（从 0 或从现状升级）；
  - **campaign_or_copy**：单次活动策划或单篇/多篇文案（现有能力）。

这样后续规划与编排才能**按任务类型**选择不同流程与输出结构。

### 3.2 规划与编排：缺少「IP 诊断 / IP 打造」的专门路径

- **现状**：规划脑输出的是通用步骤（web_search、memory_query、kb_retrieve、analyze、generate、evaluate），汇总节点把各步结果拼成一份报告；内容形态偏向「一次分析 + 一次生成」的**活动/文案**产出。
- **缺口**：
  - **IP 诊断**：需要「诊断专用」的输入结构（如：账号现状、内容样本、数据情况、人设与定位）和**输出结构**（如：现状小结、问题清单、优先级、改进方向），而不是通用分析+生成文案。
  - **IP 打造方案**：需要「完整方案」的**输出结构**（如：人设与定位、内容矩阵、变现路径、阶段节奏、关键动作、可落地的执行清单），并可复用现有知识库/案例/方法论，但**以「方案报告」为主形态**，而不是以单次活动或单篇文案为主。

即：在**同一套编排**下，通过「任务类型」分支不同**步骤组合 + 汇总模板**，或增加少量专用步骤（如 `ip_diagnosis`、`ip_building_plan`），使「活动策划+文案」与「IP 诊断」「IP 打造方案」并行存在。

### 3.3 知识与案例：缺少「IP 向」的方法论与案例形态

- **现状**：知识库与方法论以「营销方法论、内容日历、竞品分析」等为主；案例模板以「营销策略案例」为主，标签为 industry、goal_type、scenario_tags。
- **缺口**：
  - **IP 方法论**：在方法论模块或知识库中增加「IP 诊断框架」「IP 打造框架」（如：人设一致性、内容矩阵、变现闭环、常见问题清单），供诊断与打造方案生成时检索。
  - **IP 案例**：案例库支持「IP 打造 / IP 诊断」类案例（如通过 goal_type 或 scenario_tags 区分），便于「同类客户同类问题 → 快速调用案例/模板」。

### 3.4 入口与体验：是否要单独暴露「IP 诊断 / IP 打造」

- **现状**：活动策划已并入统一入口；深度分析走 frontend/chat 等，由意图+规划（含 task_type）决定步骤，task_type=campaign_or_copy 时编排层走 strategy_orchestrator。
- **可选**：为「IP 诊断」「IP 打造方案」提供**单独 API 或统一入口上的 task_type**，便于前端按场景展示（如「诊断我的 IP」「生成完整打造方案」「做一次活动策划」），具体要做什么仍由客户意图驱动，但产品形态更清晰。

### 3.5 是否还需要单独的活动策划接口

- **结论：不需要长期单独保留。** 目标已是「具体要做什么看客户意图」，活动策划应作为**任务类型之一**由统一入口（如 `frontend/chat`）驱动，而不是与对话并列的独立产品线。
- **已采用方案 A**：在 meta_workflow 编排层，当 task_type=campaign_or_copy 时内部走 strategy_orchestrator（方法论 + 知识库 + 案例 并行 → 一次生成）；`POST /api/v1/campaign/plan` 已下线，前端只保留会话入口（如 `frontend/chat`）。

---

## 四、建议的后续动作（按优先级）

### P0：意图层区分「任务类型」（IP 诊断 / IP 打造 / 活动·文案）

- **做法**：在现有意图识别结果上增加 **task_type**（或等价字段），取值建议：`ip_diagnosis` | `ip_building_plan` | `campaign_or_copy`。
  - 可在意图分类 prompt 中明确说明：若用户表达「诊断账号」「看看我的 IP 有什么问题」「账号做不起来」等 → ip_diagnosis；「从 0 做 IP」「完整 IP 方案」「人设+内容矩阵」等 → ip_building_plan；其余营销/推广/文案类 → campaign_or_copy。
  - 若希望少改接口，可先在同一 intent（如 free_discussion）下增加 task_type，由规划脑读取 task_type 再决定步骤与汇总形态。
- **产出**：调用深度分析/活动策划前，上下文中带 **task_type**，供规划与编排使用。

### P1：规划与编排支持「IP 诊断」「IP 打造方案」分支

- **做法**：
  - **规划脑**：若 task_type 为 ip_diagnosis，可规划步骤如：memory_query（可选）+ kb_retrieve（IP 诊断方法论）+ **ip_diagnosis**（或拆成：收集现状 → 诊断分析）；若为 ip_building_plan，可规划 kb_retrieve + 案例检索 + **ip_building_plan**（或：分析目标与现状 → 输出完整方案）；若为 campaign_or_copy，维持现有 web_search + memory_query + kb_retrieve + analyze + generate + evaluate。
  - **编排层**：对步骤名 `ip_diagnosis`、`ip_building_plan` 做专门处理：调用专用 prompt 或轻量子流程，输出**结构化诊断报告**或**完整打造方案**（见下），再交给汇总节点。
  - **汇总节点**：根据 task_type 或步骤结果，选择「诊断报告模板」或「打造方案模板」或现有活动/文案报告模板，拼成最终返回内容。
- **产出**：用户说「诊断我的 IP」时，得到的是「诊断报告」；说「给我完整 IP 打造方案」时，得到的是「完整打造方案」；说「做个 618 策划」时，仍是活动策划+文案。**具体做什么由客户意图决定。**

### P2：定义「完整打造方案」与「IP 诊断」的输出结构

- **做法**：
  - **IP 诊断报告**：约定章节如：现状小结、问题清单（含优先级）、根因简析、改进方向与建议；便于前端展示和后续迭代。
  - **完整 IP 打造方案**：约定章节如：人设与定位、内容矩阵、变现路径、阶段节奏与里程碑、关键动作、执行清单（可选）；与现有「活动方案」区分开，突出「完整」和「可执行」。
  - 在编排层对应步骤的 prompt 中显式要求按上述结构输出（或先输出结构化 JSON/大纲再转成可读报告）。
- **产出**：两种形态的标准化输出，便于体验一致和后续做模板/案例沉淀。

### P3：知识库与方法论中的「IP 向」内容

- **做法**：
  - 在方法论模块或 knowledge 下增加「IP 诊断框架」「IP 打造框架」文档（如：人设一致性、内容矩阵、变现闭环、常见 IP 问题清单），供 kb_retrieve 或专用步骤检索。
  - 案例模板的 goal_type / scenario_tags 支持「IP 诊断」「IP 打造」等，便于检索与复用。
- **产出**：诊断与打造方案生成时能拉取到 IP 相关方法论与案例，而不是仅靠通用营销方法论。

### P4（可选）：单独入口或前端任务类型选择

- **做法**：提供 `POST /api/v1/ip/diagnose`、`POST /api/v1/ip/building-plan` 或在现有深度分析接口中增加参数 **task_type**，由前端在「诊断我的 IP」「生成完整打造方案」「做活动策划」等场景下传入，后端仍可结合意图做二次校验或覆盖。
- **产出**：产品形态上明确「IP 诊断」「IP 打造方案」与「活动策划」并列，便于运营与用户理解。

---

## 五、小结

- **今天的修改**：为「按意图调度、知识/案例/方法论复用、数据闭环」打下了基础，**对终极目标而言是合理且必要的一步**，但没有直接实现「完整 IP 打造 / IP 诊断」。
- **要真正达成目标**，还需要：
  1. **意图层**区分任务类型：ip_diagnosis / ip_building_plan / campaign_or_copy；
  2. **规划与编排**中为 IP 诊断、IP 打造方案设专门分支与输出结构；
  3. **知识库与方法论**中补充 IP 诊断与 IP 打造框架，案例库支持 IP 类案例；
  4. （可选）**单独 API 或 task_type 参数**，让「具体要做什么」在产品和前端上更清晰，仍由客户意图驱动。

按上述顺序推进（P0 → P1 → P2 → P3 → P4），可以在现有架构上逐步把「完整 IP 打造」和「IP 诊断」做成与「活动策划+文案」并列的一等能力，最终实现「帮用户打造完整且成功的 IP，或诊断当前 IP 后给出完整打造方案，具体做什么看客户意图」的终极目标。
