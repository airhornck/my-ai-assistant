# 知识库：营销方法论管理与积累

本目录存放营销方法论等 Markdown 文档，供 `RetrievalService` 向量检索使用（活动策划等场景会注入为「行业知识」）。

---

## 一、当前机制（你只需知道的两点）

1. **谁被加载**：本目录及子目录下**所有 `.md` 文件**都会被加载、分块、嵌入并参与检索（`**/*.md`）。
2. **何时更新索引**：只有在你**删除 `./data/knowledge_vectors/` 目录**后，下次发生检索时才会重新建索引；平时改/增 `.md` 不会自动生效。

---

## 二、如何「管理」营销方法论

### 1. 目录与文件怎么组织（建议）

按主题拆文件，便于后续增删和 review，检索时不会区分目录，只按内容相似度命中：

```
knowledge/
├── README.md                    # 本说明（也会被索引，若仅作说明可改名或移出）
├── marketing_knowledge.md       # 通用营销方法论（现有）
├── content_calendar.md          # 内容日历、排期方法论（可拆自 marketing_knowledge）
├── competitor_analysis.md       # 竞品分析框架
├── copywriting.md              # 文案、标题、金句原则
└── channels/                   # 可选：按渠道再分子目录
    ├── xiaohongshu.md
    ├── douyin.md
    └── bilibili.md
```

- **一个主题一个文件**：方便「积累」时单点更新、减少冲突。
- **文件名要有语义**：检索不依赖文件名，但你自己管理时一眼能看懂。
- **子目录随意**：`**/*.md` 会递归扫，子目录里的 `.md` 一样会被索引。

### 2. 文档怎么写更利于检索

- **每篇一个清晰的一级标题**（如 `# 内容日历规划`），下面用 `##` 分小节。
- **段落不要过长**：当前按「空行分段 + 单段超 500 字再按 500 字切块」，所以一段一个方法论要点、控制在几百字内，更容易被精准命中。
- **关键概念写进正文**：如「618」「新品上市」「种草」「B 站」等，用户问到时才容易检索到；不要只在标题里写。

无需 YAML frontmatter，当前检索只看正文；若以后要做「仅检索某类文档」再考虑加元数据。

### 3. 不想被检索的内容

- 本目录下**只有 `.md` 会参与检索**；若某文件只是给人看的说明，可以：
  - 改成非 `.md`（如 `README.txt`），或
  - 放到 `knowledge` 以外的目录。

---

## 三、如何「积累」营销方法论

### 1. 日常积累流程（推荐）

1. **新增或修改**：在 `knowledge/`（或子目录）下新增或编辑 `.md` 文件。
2. **让索引生效**：删除项目根目录下的 `./data/knowledge_vectors/` 文件夹（若不存在则跳过）。
3. **触发重建**：下一次发生「活动策划」或任何调用 `RetrievalService.retrieve()` 的请求时，会自动用当前所有 `.md` 重新分块、嵌入并写入 `./data/knowledge_vectors/vectors.json`。

无需跑单独脚本，只要删掉向量目录，下次检索即会重建。

### 2. 积累什么内容更有效

- **方法论与框架**：如「内容日历 4:3:2:1」「竞品分析四维度」「热点评估表」—— 适合你当前「让方案更专业」的目标。
- **原则与红线**：如「品牌叙事与热点结合」的注意点、各平台调性差异—— 便于检索到后约束生成质量。
- **可复用的结构**：如「活动方案通常包含：目标、节奏、渠道、预算、KPI」—— 有助于生成更统一、可复用的结构。

避免大段复制粘贴网文或案例原文，尽量**自己提炼成短段落、要点化**，检索和生成效果更好。

### 3. 版本与协作（可选）

- 用 **Git** 管理 `knowledge/` 目录：每次新增/大改方法论时做一次 commit，方便回溯「什么时候加了哪条方法」。
- 若多人维护，可在 `knowledge/` 下加一个 `CHANGELOG.md`（或 `updates.txt`），简单记录「日期 + 新增/修改了哪几个文件或主题」，便于 review 和交接。

---

## 四、环境变量（可选）

| 变量 | 含义 | 默认值 |
|------|------|--------|
| `KNOWLEDGE_DIR` | 知识库根目录 | `./knowledge` |
| `KNOWLEDGE_VECTOR_DIR` | 向量索引持久化目录 | `./data/knowledge_vectors` |

修改 `KNOWLEDGE_DIR` 后，需删除**新配置下**的向量目录才会在下次检索时用新路径重建。

---

## 五、小结：管理和积累清单

| 你想做的事 | 具体操作 |
|-----------|----------|
| 新增一条方法论 | 在 `knowledge/` 下新增或编辑 `.md` → 删除 `./data/knowledge_vectors/` → 下次检索自动重建 |
| 调整某篇文档 | 改对应 `.md` → 删除 `./data/knowledge_vectors/` → 下次检索自动重建 |
| 按主题管理 | 用多文件 + 子目录（如 `content_calendar.md`、`channels/douyin.md`） |
| 让检索更准 | 每段一个要点、控制段落长度、关键概念写进正文 |
| 长期积累 | Git 管理 `knowledge/`，可选 CHANGELOG 记录变更 |

按上述方式管理和积累，营销方法论会持续被检索并注入活动策划，使输出更垂直、更专业。
